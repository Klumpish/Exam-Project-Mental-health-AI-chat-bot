# Docker Compose file for running PostgreSQL locally
# For an easy start database for development
# Run with: docker-compose up -d


services:
    # PostgreSQL database
    postgres:
        image: postgres:15-alpine
        container_name: ${DB_CONTAINER_NAME:-mental_health_dev_db}
        environment:
            # Database credentials
            #These have to be the same in both, application.properties in /backend
            POSTGRES_DB: ${DB_NAME:-mental_health_dev_db}
            POSTGRES_USER: ${DB_USERNAME:-dev_user}
            POSTGRES_PASSWORD: ${DB_PASSWORD:-dev_password}
        ports:
            # Expose PostgreSQL on localhost:5432
            - "5432:5432"
        volumes:
            # Persist database data
            - postgres_data:/var/lib/postgresql/data
        networks:
            - chatbot_network

    # (Optional) pgAdmin for database management UI
    pgAdmin:
        image: dpage/pgadmin4:latest
        container_name: ${DB_PGADMIN_NAME:-pgAdmin_dev}
        environment:
            #TODO change in prod
            PGADMIN_DEFAULT_EMAIL: ${PGADMIN_EMAIL:-admin@example.com}
            PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_PASSWORD:-admin}
        ports:
            - "5050:80"
        networks:
            - chatbot_network
        depends_on:
            - postgres

# Define volumes for data persistence
volumes:
    postgres_data:

# Define network for services to communicate
networks:
    chatbot_network:
        driver: bridge
